<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF--8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>BeachSpot</title>
    <link rel="icon" type="image/png" href="../assets/icons/Logo BeachSpot.png">
    <script src="https://cdn.tailwindcss.com"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

    <script src="https://unpkg.com/lucide@latest"></script>

    <link href='https://unpkg.com/maplibre-gl@latest/dist/maplibre-gl.css' rel='stylesheet' />
    
    <script src='https://unpkg.com/maplibre-gl@latest/dist/maplibre-gl.js'></script>

    <link rel="stylesheet" href="../assets/css/infoBarraca.css">
    
    <style>
        /* Estilo apenas para o estado de favorito, sem alterar cores originais */
        .is-favorited .lucide-heart {
            fill: #ef4444; /* Cor vermelha para o coração preenchido */
            color: #ef4444; /* Cor vermelha para la borda */
        }
        /* Melhora a aparência dos popups do mapa */
        .maplibregl-popup-content {
            font-family: 'Poppins', sans-serif;
            font-weight: 500;
            padding: 8px 12px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .map-directions-link {
            display: inline-block;
            margin-top: 8px;
            padding: 5px 12px;
            background-color: #0138b4;
            color: white !important;
            text-decoration: none;
            border-radius: 9999px;
            font-size: 13px;
            font-weight: 600;
            transition: background-color 0.2s;
        }
        .map-directions-link:hover {
            background-color: #002a8c;
        }
        /* Para garantir que as imagens da galeria tenham o mesmo tamanho */
        .gallery-item {
            height: 200px; /* Altura fixa para todos os itens da galeria */
        }
        .gallery-item img {
            width: 100%;
            height: 100%;
            object-fit: cover; /* Garante que a imagem cubra a área sem distorcer */
        }
    </style>
</head>
<body class="text-white">

    <header class="bg-white text-gray-800 fixed top-0 left-0 right-0 z-50 shadow-md">
        <nav class="container mx-auto max-w-6xl px-6 py-4 flex justify-between items-center">
            <a href="inicio.html" class="flex items-center">
                <img src="../assets/icons/Logo Preta.png" alt="Logo Beachspot" class="h-5 w-auto">
            </a>
            
            <div class="flex items-center space-x-6">
                <a href="inicio.html" class="hidden md:block text-gray-600 hover:text-blue-600 transition duration-300 font-medium">Início</a>
                <a href="suasReservas.html" class="hidden md:block text-gray-600 hover:text-blue-600 transition duration-300 font-medium">Suas Reservas</a>
    
                <a href="configuracoes.html" class="text-gray-600 hover:text-blue-600 transition duration-300">
                    <i data-lucide="settings" class="w-6 h-6"></i>
                </a>
    
                <a href="perfilCliente.html">
                    <img src="https://placehold.co/40x40/0138b4/FFFFFF?text=C" alt="Avatar do Cliente" class="w-10 h-10 rounded-full border-2 border-blue-600 hover:opacity-90 transition-opacity">
                </a>
            </div>
        </nav>
    </header>

    <main class="pt-28 md:pt-32 container mx-auto max-w-7xl px-6 pb-28">
        
        <div class="bg-white text-gray-800 rounded-2xl p-6 md:p-10 shadow-lg">
            
            <section class="flex flex-col md:flex-row items-center gap-8 border-b border-gray-200 pb-8">
                <div class="w-full md:w-1/3 text-center">
                    <img src="https://placehold.co/400x300/0138b4/FFFFFF?text=Ax%C3%A9" alt="Barraca Axé Bahia" class="w-full h-auto rounded-xl object-cover shadow-md">
                    <a href="perfilGestor.html" class="inline-flex items-center justify-center gap-2 text-gray-500 hover:text-blue-600 text-sm transition-colors mt-2">
                        <i data-lucide="user-circle" class="w-4 h-4"></i>
                        <span>Ver perfil do gestor</span>
                    </a>
                </div>
                
                <div class="flex-1 md:text-left w-full"> 
                    <div class="flex items-start justify-between">
                          <div>
                              <h1 class="text-4xl font-bold text-gray-900 text-left">Barraca Axé Bahia</h1>
                              <div id="review-summary" class="flex items-center justify-start my-2">
                                  <div class="flex text-yellow-500">
                                      <i data-lucide="star" class="w-5 h-5 fill-current"></i>
                                      <i data-lucide="star" class="w-5 h-5 fill-current"></i>
                                      <i data-lucide="star" class="w-5 h-5 fill-current"></i>
                                      <i data-lucide="star" class="w-5 h-5 fill-current"></i>
                                      <i data-lucide="star" class="w-5 h-5"></i>
                                  </div>
                                  <span id="review-summary-text" class="ml-2 text-gray-600">4.3 (3 avaliações)</span>
                              </div>
                               <div class="flex items-center justify-start mt-2 text-gray-700 font-semibold">
                                <i data-lucide="dollar-sign" class="w-5 h-5 mr-2 text-green-600"></i>
                                <span>Preço médio: R$ 80 por pessoa</span>
                            </div>
                        </div>
                         <div class="flex items-center gap-2">
                              <button id="favorite-btn" class="text-gray-400 hover:text-red-500 transition-colors p-2 rounded-full">
                                  <i data-lucide="heart" class="w-7 h-7"></i>
                              </button>
                      </div>
                    </div>
                    
                    <button id="location-btn" class="mt-4 mx-auto md:mx-0 inline-flex items-center gap-2 bg-blue-50 text-blue-700 font-semibold py-2 px-4 rounded-full hover:bg-blue-100 transition-colors text-left">
                        <i data-lucide="map-pin" class="w-4 h-4 flex-shrink-0"></i>
                        <span id="location-text">Carregando localização...</span>
                    </button>

                    <section id="weather-section" class="bg-gray-50 p-4 rounded-lg text-left mt-4 max-w-md mx-auto md:mx-0 cursor-pointer hover:bg-gray-100 transition-colors duration-300">
                        <div id="current-weather-clickable" class="flex items-center justify-between">
                             <div class="flex items-center gap-4">
                                 <img id="weather-icon" src="https://placehold.co/48x48/ccc/FFFFFF?text=..." alt="Ícone do tempo" class="w-12 h-12">
                                 <div>
                                     <p class="font-bold text-gray-800 text-2xl" id="weather-temp">--°C</p>
                                     <p class="text-gray-600" id="weather-condition">Carregando...</p>
                                 </div>
                             </div>
                             <div class="text-right">
                                <i data-lucide="chevron-down" id="weather-chevron" class="w-6 h-6 text-gray-500 transition-transform duration-300"></i>
                             </div>
                        </div>

                        <div id="forecast-container" class="hidden pt-4 mt-4 border-t border-gray-200 flex justify-around text-center">
                            </div>
                    </section>
                    </div>
                </section>
             <section class="py-8">
                 <div class="flex flex-col sm:flex-row gap-4">
                    <a href="reservar.html" id="reserve-btn" class="flex-1 bg-blue-600 text-white font-bold py-3 px-8 rounded-full hover:bg-blue-700 transition-all transform hover:scale-105 shadow-lg text-center block">Reservar</a>
                     <a href="cardapio.html" class="flex-1 text-center bg-blue-800 text-white font-bold py-3 px-8 rounded-full hover:bg-blue-900 transition-all transform hover:scale-105">Cardápio</a>
                 </div>
            </section>

            <section class="pt-8 mt-8 border-t border-gray-200">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">Promoções do Dia</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-blue-800 p-3 rounded-xl shadow-lg">
                        <div>
                            <h3 class="font-bold text-lg text-white">Happy Hour!</h3>
                            <p class="text-blue-100">Dose dupla de cerveja long neck das 16h às 18h.</p>
                        </div>
                    </div>
                    <div class="bg-blue-800 p-3 rounded-xl shadow-lg">
                        <div>
                            <h3 class="font-bold text-lg text-white">Moqueca Especial</h3>
                            <p class="text-blue-100">20% de desconto na Moqueca de Peixe para duas pessoas.</p>
                        </div>
                    </div>
                </div>
            </section>
            <div class="mt-8">
                <div class="border-b border-gray-200">
                    <nav class="-mb-px flex justify-center md:justify-start space-x-4 md:space-x-8" aria-label="Tabs">
                        <button data-tab-target="geral" class="tab-btn whitespace-nowrap py-4 px-1 border-b-2 font-semibold text-base md:text-lg border-blue-600 text-blue-600">
                            Geral
                        </button>
                        <button data-tab-target="galeria" class="tab-btn whitespace-nowrap py-4 px-1 border-b-2 font-semibold text-base md:text-lg border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300">
                            Galeria
                        </button>
                        <button data-tab-target="avaliacoes" class="tab-btn whitespace-nowrap py-4 px-1 border-b-2 font-semibold text-base md:text-lg border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300">
                            Avaliações
                        </button>
                    </nav>
                </div>

                <div class="py-8">
                    <div id="tab-content-geral" class="tab-content">
                        <section>
                            <h2 class="text-2xl font-bold text-gray-800 mb-4">Informações Gerais</h2>
                            <div class="space-y-4 text-gray-600 leading-relaxed">
                                <p>Uma das barracas mais animadas da Praia do Porto da Barra, oferecendo o melhor do acarajé e da música baiana. Ambiente descontraído com vista privilegiada para o mar.</p>
                            </div>
                            <div class="mt-6 pt-6 border-t border-gray-200">
                                <h3 class="text-xl font-bold text-gray-800 mb-3">Categorias</h3>
                                <div class="flex flex-wrap gap-3">
                                    <span class="inline-flex items-center bg-blue-100 text-blue-800 text-sm font-semibold px-3 py-1.5 rounded-full"><i data-lucide="music" class="w-4 h-4 mr-1.5"></i>Música ao Vivo</span>
                                    <span class="inline-flex items-center bg-blue-100 text-blue-800 text-sm font-semibold px-3 py-1.5 rounded-full"><i data-lucide="zap" class="w-4 h-4 mr-1.5"></i>Ambiente Agitado</span>
                                    <span class="inline-flex items-center bg-blue-100 text-blue-800 text-sm font-semibold px-3 py-1.5 rounded-full"><i data-lucide="users" class="w-4 h-4 mr-1.5"></i>Bom para Grupos</span>
                                    <span class="inline-flex items-center bg-blue-100 text-blue-800 text-sm font-semibold px-3 py-1.5 rounded-full"><i data-lucide="waves" class="w-4 h-4 mr-1.5"></i>Vista para o Mar</span>
                                    <span class="inline-flex items-center bg-blue-100 text-blue-800 text-sm font-semibold px-3 py-1.5 rounded-full"><i data-lucide="accessibility" class="w-4 h-4 mr-1.5"></i>Acessível</span>
                                </div>
                            </div>
                        </section>
                    </div>

                    <div id="tab-content-galeria" class="tab-content hidden">
                         <section>
                            <h2 class="text-2xl font-bold text-gray-800 mb-4">Galeria de Fotos</h2>
                            <div id="gallery" class="max-h-[600px] overflow-y-auto pr-2 grid grid-cols-2 md:grid-cols-3 gap-4">
                                
                                <div class="gallery-item rounded-lg shadow-md cursor-pointer overflow-hidden">
                                    <img src="https://www.rodei.com.br/wp-content/uploads/2019/05/Barraca-Rio-da-Barra-50.jpg" alt="Vista da barraca" class="hover:scale-105 transition-transform duration-300">
                                </div>
                                
                                <div class="gallery-item rounded-lg shadow-md cursor-pointer overflow-hidden">
                                    <img src="https://simonde.com.br/wp-content/uploads/2017/12/uxua-quadrado-trancoso-bahia-hoteis-de-luxo-critica-review-1100-36-1024x682.jpg.webp" alt="Área de mesas" class="hover:scale-105 transition-transform duration-300">
                                </div>
                                
                                <div class="gallery-item rounded-lg shadow-md cursor-pointer overflow-hidden">
                                    <img src="https://media-cdn.tripadvisor.com/media/photo-s/0b/70/33/4a/melhor-barraca-restaurante.jpg" alt="Pratos servidos" class="hover:scale-105 transition-transform duration-300">
                                </div>
                                
                                <div class="gallery-item rounded-lg shadow-md cursor-pointer overflow-hidden">
                                    <img src="https://media-cdn.tripadvisor.com/media/photo-s/04/32/53/44/barraca-marguerita.jpg" alt="Vista do mar" class="hover:scale-105 transition-transform duration-300">
                                </div>
                                
                                <div class="gallery-item rounded-lg shadow-md cursor-pointer overflow-hidden">
                                    <img src="https://images.squarespace-cdn.com/content/v1/5a9860afe2ccd11b71a53b86/1609959600114-1110UXW0CEBF3021575D/Top+10+melhores+barracas+de+praia+em+Trancoso.jpg" alt="Detalhe" class="hover:scale-105 transition-transform duration-300">
                                </div>
                                
                                 <div class="gallery-item rounded-lg shadow-md cursor-pointer overflow-hidden">
                                    <img src="https://media-cdn.tripadvisor.com/media/photo-s/17/5a/09/5c/a-barraca-do-luiz-fica.jpg" alt="Comida na praia" class="hover:scale-105 transition-transform duration-300">
                                </div>
                            
                            </div>
                        </section>
                    </div>

                    <div id="tab-content-avaliacoes" class="tab-content hidden">
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-12">
                            <section>
                                 <h2 class="text-2xl font-bold text-gray-800 mb-4">O que dizem os clientes</h2>
                                 
                                 <div class="flex justify-center gap-2 mb-4">
                                     <button id="filter-all" class="filter-btn flex-1 bg-blue-500 text-white font-semibold py-2 px-4 rounded-full transition-colors">Todas</button>
                                     <button id="filter-media" class="filter-btn flex-1 bg-gray-200 text-gray-800 font-semibold py-2 px-4 rounded-full hover:bg-gray-300 transition-colors">Com Mídia</button>
                                 </div>
        
                                 <div id="reviews-list" class="space-y-4 max-h-[400px] overflow-y-auto pr-2">
                                     <div class="review-card has-media p-4 border rounded-lg bg-gray-50" data-rating="5">
                                         <div class="flex items-center mb-2">
                                             <img src="https://placehold.co/40x40/FFC107/FFFFFF?text=J" class="w-10 h-10 rounded-full mr-3" alt="Foto de João P.">
                                             <div>
                                                 <p class="font-bold">João P.</p>
                                                 <div class="flex text-yellow-500">
                                                     <i data-lucide="star" class="w-4 h-4 fill-current"></i><i data-lucide="star" class="w-4 h-4 fill-current"></i><i data-lucide="star" class="w-4 h-4 fill-current"></i><i data-lucide="star" class="w-4 h-4 fill-current"></i><i data-lucide="star" class="w-4 h-4 fill-current"></i>
                                                 </div>
                                             </div>
                                         </div>
                                         <p class="text-gray-600 mb-2">Atendimento sensacional e a comida estava divina! Recomendo a moqueca.</p>
                                         <img src="https://media-cdn.tripadvisor.com/media/photo-s/0b/70/33/4a/melhor-barraca-restaurante.jpg" class="rounded-lg w-full h-auto object-cover" alt="Foto da avaliação de João P.">
                                     </div>
        
                                     <div class="review-card p-4 border rounded-lg bg-gray-50" data-rating="4">
                                         <div class="flex items-center mb-2">
                                             <img src="https://placehold.co/40x40/4CAF50/FFFFFF?text=M" class="w-10 h-10 rounded-full mr-3" alt="Foto de Maria S.">
                                             <div>
                                                 <p class="font-bold">Maria S.</p>
                                                 <div class="flex text-yellow-500">
                                                     <i data-lucide="star" class="w-4 h-4 fill-current"></i><i data-lucide="star" class="w-4 h-4 fill-current"></i><i data-lucide="star" class="w-4 h-4 fill-current"></i><i data-lucide="star" class="w-4 h-4 fill-current"></i><i data-lucide="star" class="w-4 h-4"></i>
                                                 </div>
                                             </div>
                                         </div>
                                         <p class="text-gray-600">Lugar muito agradável e cadeiras confortáveis. A cerveja estava bem gelada. Voltarei com certeza!</p>
                                     </div>
        
                                      <div class="review-card has-media p-4 border rounded-lg bg-gray-50" data-rating="4">
                                         <div class="flex items-center mb-2">
                                             <img src="https://placehold.co/40x40/F44336/FFFFFF?text=C" class="w-10 h-10 rounded-full mr-3" alt="Foto de Carlos F.">
                                             <div>
                                                 <p class="font-bold">Carlos F.</p>
                                                 <div class="flex text-yellow-500">
                                                     <i data-lucide="star" class="w-4 h-4 fill-current"></i><i data-lucide="star" class="w-4 h-4 fill-current"></i><i data-lucide="star" class="w-4 h-4 fill-current"></i><i data-lucide="star" class="w-4 h-4 fill-current"></i><i data-lucide="star" class="w-4 h-4"></i>
                                                 </div>
                                             </div>
                                         </div>
                                         <p class="text-gray-600 mb-2">Vista incrível. Ótimo para passar o dia com a família.</p>
                                         <img src="https://www.rodei.com.br/wp-content/uploads/2019/05/Barraca-Rio-da-Barra-50.jpg" class="rounded-lg w-full h-auto object-cover" alt="Foto da avaliação de Carlos F.">
                                     </div>
                                 </div>
                            </section>
                            
                            <section id="review-form-section">
                                <h2 class="text-2xl font-bold text-gray-800 mb-4">Deixe sua Avaliação</h2>
                                
                                <div id="review-form-container">
                                    <div class="flex items-center justify-center mb-4">
                                        <span class="mr-4 text-gray-700 font-semibold">Sua nota:</span>
                                        <div class="flex text-gray-300 space-x-1" id="rating-stars">
                                            <i data-lucide="star" data-value="1" class="w-8 h-8 cursor-pointer hover:text-yellow-400 transition-colors"></i>
                                            <i data-lucide="star" data-value="2" class="w-8 h-8 cursor-pointer hover:text-yellow-400 transition-colors"></i>
                                            <i data-lucide="star" data-value="3" class="w-8 h-8 cursor-pointer hover:text-yellow-400 transition-colors"></i>
                                            <i data-lucide="star" data-value="4" class="w-8 h-8 cursor-pointer hover:text-yellow-400 transition-colors"></i>
                                            <i data-lucide="star" data-value="5" class="w-8 h-8 cursor-pointer hover:text-yellow-400 transition-colors"></i>
                                        </div>
                                    </div>
                                    <textarea id="review-textarea" placeholder="Escreva seu comentário aqui..." rows="3" class="w-full p-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 transition"></textarea>
                                    <button id="submit-review-btn" class="mt-4 w-full bg-blue-600 text-white font-bold py-3 px-8 rounded-full hover:bg-blue-700 transition-colors shadow-lg">Enviar Avaliação</button>
                                </div>

                                <div id="user-review-placeholder" class="hidden text-center">
                                    <p class="text-gray-600 mb-2">Você já enviou sua avaliação.</p>
                                    <button id="delete-review-btn" class="text-sm text-red-500 hover:underline font-semibold">Apagar sua avaliação</button>
                                </div>
                            </section>
                            </div>
                    </div>
                </div>
            </div>

        </div>
    </main>

    <footer class="w-full bg-white text-gray-800 z-10 py-12 mt-16">
        <div class="container mx-auto max-w-6xl px-6">
            <div class="flex flex-wrap justify-between items-start text-left">
                <div class="w-full md:w-auto mb-8 md:mb-0">
                    <a href="inicio.html" class="flex items-center">
                        <img src="../assets/icons/Logo Preta.png" alt="Logo Beachspot" class="h-5 w-auto" onerror="this.onerror=null;this.src='https://placehold.co/150x40/000000/FFFFFF?text=beachspot&font=sans';">
                    </a>
                </div>
                <div class="w-1/2 md:w-auto mb-8 md:mb-0">
                    <h3 class="font-bold mb-3">Navegação</h3>
                    <ul class="space-y-2">
                        <li><a href="inicio.html" class="hover:text-blue-600 transition-colors">Início</a></li>
                        <li><a href="suasReservas.html" class="hover:text-blue-600 transition-colors">Suas Reservas</a></li>
                        <li><a href="configuracoes.html" class="hover:text-blue-600 transition-colors">Configurações</a></li>
                        <li><a href="perfilCliente.html" class="hover:text-blue-600 transition-colors">Perfil</a></li>
                    </ul>
                </div>
                <div class="w-1/2 md:w-auto">
                    <h3 class="font-bold mb-3">Redes Sociais</h3>
                    <div class="flex space-x-4">
                        <a href="https://www.instagram.com/empresa_beachspot/" class="hover:text-blue-600 transition-colors"><i data-lucide="instagram"></i></a>
                        <a href="https://x.com/site_beachspot" class="hover:text-blue-600 transition-colors"><i data-lucide="twitter"></i></a>
                    </div>
                </div>
            </div>
            <div class="text-center mt-12 border-t border-gray-200 pt-6">
                <p>© 2025 Beachspot. Todos os direitos reservados.</p>
            </div>
        </div>
    </footer>

    <div id="toast" class="fixed bottom-5 right-5 bg-gray-800 text-white py-3 px-5 rounded-lg shadow-lg opacity-0 translate-y-3 transition-all duration-300 z-50"></div>

    <div id="gallery-modal" class="hidden fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-50">
        <button id="modal-close" class="absolute top-4 right-4 text-white text-5xl leading-none hover:text-gray-300">×</button>
        <img id="modal-image" src="" alt="Imagem da galeria em tamanho maior" class="max-w-[90vw] max-h-[90vh] rounded-lg">
    </div>

    <div id="map-modal" class="hidden fixed inset-0 bg-black/60 flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-2xl shadow-xl w-full max-w-6xl h-[90vh] flex overflow-hidden relative text-gray-800">
             <button id="map-modal-close" class="absolute top-4 right-4 text-gray-500 hover:text-gray-800 text-3xl leading-none z-10 bg-white/70 rounded-full w-10 h-10 flex items-center justify-center backdrop-blur-sm">×</button>
            
            <div id="location-info-panel" class="w-full md:w-1/3 bg-gray-50 p-6 overflow-y-auto">
                <h2 class="text-3xl font-bold text-gray-900 mb-2" id="info-nome"></h2>
                <p class="text-gray-600 mb-6 pb-6 border-b" id="info-endereco"></p>

                <div class="space-y-6">
                    <div>
                        <h3 class="font-semibold text-xl text-gray-700 mb-4">Pontos Turísticos</h3>
                        <div id="info-turisticos" class="space-y-3">
                            </div>
                    </div>

                    <div>
                        <h3 class="font-semibold text-xl text-gray-700 mb-4">Nas Proximidades</h3>
                        <div id="info-proximos">
                            </div>
                    </div>
                </div>
            </div>

            <div id='map' class="w-full md:w-2/3 h-full"></div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            lucide.createIcons();
            
            // --- Lógica para controle das abas ---
            const tabs = document.querySelectorAll('.tab-btn');
            const tabContents = document.querySelectorAll('.tab-content');

            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const target = tab.dataset.tabTarget;

                    tabs.forEach(t => {
                        t.classList.remove('border-blue-600', 'text-blue-600');
                        t.classList.add('border-transparent', 'text-gray-500', 'hover:text-gray-700', 'hover:border-gray-300');
                    });
                    tab.classList.add('border-blue-600', 'text-blue-600');
                    tab.classList.remove('border-transparent', 'text-gray-500');

                    tabContents.forEach(content => {
                        content.classList.add('hidden');
                        if (content.id === `tab-content-${target}`) {
                            content.classList.remove('hidden');
                        }
                    });
                });
            });

            // --- Dados da Localização (simulação) ---
            const locationData = {
                nome: "Barraca Axé Bahia",
                endereco: "Praia do Porto da Barra, Barra, Salvador - BA",
                coordenadas: { lng: -38.5230, lat: -12.9985 },
                pontosTuristicos: [
                    { nome: "Farol da Barra", tipo: "Ponto Turístico", coordenadas: { lng: -38.5328, lat: -13.0105 } },
                    { nome: "Morro do Cristo", tipo: "Monumento", coordenadas: { lng: -38.5126, lat: -13.0044 } }
                ],
                lugaresProximos: [
                     { nome: "Yacht Clube da Bahia", tipo: "Clube", categoria: "Clubes", coordenadas: { lng: -38.5222, lat: -12.9932 } },
                    { nome: "Restaurante Acarajé Dourado", tipo: "Culinária Baiana", categoria: "Restaurantes", coordenadas: { lng: -38.5200, lat: -12.9980 } },
                     { nome: "Monte Pascoal Praia Hotel", tipo: "Hospedagem", categoria: "Hotéis", coordenadas: { lng: -38.5273, lat: -13.0078 } },
                    { nome: "Shopping Barra", tipo: "Centro Comercial", categoria: "Compras", coordenadas: { lng: -38.5085, lat: -12.9967 } },
                    { nome: "Bompreço Supermercado", tipo: "Supermercado", categoria: "Mercados", coordenadas: { lng: -38.5147, lat: -12.9996 } },
                    { nome: "Estação Lapa", tipo: "Transporte Público", categoria: "Metrô", coordenadas: { lng: -38.5097, lat: -12.9818 } }
                ]
            };
            
            // --- API DE PREVISÃO DO TEMPO ---
            async function buscarPrevisaoTempo() {
                const apiKey = ' ee1c7addcc374cafbd0194317250610'; // Chave de API de exemplo
                const locationQuery = `${locationData.coordenadas.lat},${locationData.coordenadas.lng}`;
                const days = 3; 
                const url = `https://api.weatherapi.com/v1/forecast.json?key=${apiKey}&q=${locationQuery}&days=${days}&lang=pt`;

                const tempElement = document.getElementById('weather-temp');
                const conditionElement = document.getElementById('weather-condition');
                const iconElement = document.getElementById('weather-icon');
                const forecastContainer = document.getElementById('forecast-container');
                
                forecastContainer.innerHTML = `<p class="text-sm text-gray-500 w-full">Carregando previsão...</p>`;

                try {
                    const response = await fetch(url);
                    if (!response.ok) throw new Error('Falha na API do tempo');
                    const data = await response.json();
                    
                    const current = data.current;
                    tempElement.textContent = `${Math.round(current.temp_c)}°C`;
                    conditionElement.textContent = current.condition.text;
                    iconElement.src = `https:${current.condition.icon}`;
                    iconElement.alt = current.condition.text;

                    const forecastDays = data.forecast.forecastday;
                    forecastContainer.innerHTML = ''; 

                    forecastDays.forEach(dayData => {
                        const date = new Date(dayData.date + 'T00:00:00');
                        const dayOfWeek = date.toLocaleDateString('pt-BR', { weekday: 'short' }).slice(0, 3);
                        
                        const dayElement = document.createElement('div');
                        dayElement.className = 'flex flex-col items-center space-y-1';
                        dayElement.innerHTML = `
                            <p class="font-semibold text-sm text-gray-700">${dayOfWeek.charAt(0).toUpperCase() + dayOfWeek.slice(1)}</p>
                            <img src="https:${dayData.day.condition.icon}" alt="${dayData.day.condition.text}" class="w-8 h-8">
                            <p class="text-sm text-gray-600">
                                <span class="font-bold text-gray-800">${Math.round(dayData.day.maxtemp_c)}°</span>
                                <span>${Math.round(dayData.day.mintemp_c)}°</span>
                            </p>
                        `;
                        forecastContainer.appendChild(dayElement);
                    });
                } catch (error) {
                    console.error("Erro ao buscar previsão do tempo:", error);
                    conditionElement.textContent = 'Erro ao carregar';
                    forecastContainer.innerHTML = '<p class="text-sm text-red-500 w-full">Não foi possível carregar a previsão.</p>';
                }
            }
            buscarPrevisaoTempo();

            // --- LÓGICA PARA EXPANDIR/RECOLHER PREVISÃO ---
            const weatherSection = document.getElementById('weather-section');
            const forecastContainer = document.getElementById('forecast-container');
            const weatherChevron = document.getElementById('weather-chevron');

            weatherSection.addEventListener('click', () => {
                forecastContainer.classList.toggle('hidden');
                weatherChevron.classList.toggle('rotate-180');
            });

            // --- Sistema de Toast (Notificação) ---
            const toast = document.getElementById('toast');
            function showToast(message) {
                toast.textContent = message;
                toast.classList.remove('opacity-0', 'translate-y-3');
                setTimeout(() => {
                    toast.classList.add('opacity-0', 'translate-y-3');
                }, 3000);
            }

            // --- Botão de Favorito ---
            const favoriteBtn = document.getElementById('favorite-btn');
            favoriteBtn.addEventListener('click', () => {
                const isFavorited = favoriteBtn.classList.toggle('is-favorited');
                showToast(isFavorited ? 'Adicionado aos seus favoritos!' : 'Removido dos favoritos.');
            });

            // --- Atualiza o texto do botão de localização ---
            document.getElementById('location-text').textContent = locationData.endereco;

            // --- LÓGICA DO MODAL DO MAPA ---
            const locationBtn = document.getElementById('location-btn');
            const mapModal = document.getElementById('map-modal');
            const mapModalClose = document.getElementById('map-modal-close');
            let map; 

            locationBtn.addEventListener('click', () => {
                mapModal.classList.remove('hidden');
                document.body.style.overflow = 'hidden'; 

                document.getElementById('info-nome').textContent = locationData.nome;
                document.getElementById('info-endereco').textContent = locationData.endereco;
                
                const turisticosContainer = document.getElementById('info-turisticos');
                const proximosContainer = document.getElementById('info-proximos');
                turisticosContainer.innerHTML = ''; 
                proximosContainer.innerHTML = '';

                const createAndAppendLugar = (lugar, container) => {
                    const lugarEl = document.createElement('div');
                    lugarEl.className = 'p-3 bg-white rounded-lg border hover:shadow-md hover:border-blue-500 cursor-pointer transition-all';
                    lugarEl.innerHTML = `
                        <p class="font-semibold text-blue-700">${lugar.nome}</p>
                        <p class="text-sm text-gray-500">${lugar.tipo}</p>
                    `;
                    lugarEl.addEventListener('click', () => {
                        if(map) map.flyTo({ center: [lugar.coordenadas.lng, lugar.coordenadas.lat], zoom: 16, essential: true });
                    });
                    container.appendChild(lugarEl);
                };

                locationData.pontosTuristicos.forEach(lugar => createAndAppendLugar(lugar, turisticosContainer));
                
                const lugaresAgrupados = locationData.lugaresProximos.reduce((acc, lugar) => {
                    const categoria = lugar.categoria || 'Outros';
                    if (!acc[categoria]) acc[categoria] = [];
                    acc[categoria].push(lugar);
                    return acc;
                }, {});

                for (const categoria in lugaresAgrupados) {
                    const categoriaWrapper = document.createElement('div');
                    categoriaWrapper.className = 'mb-5';
                    categoriaWrapper.innerHTML = `<h4 class="font-semibold text-lg text-gray-600 mb-3">${categoria}</h4>`;
                    const listaLugares = document.createElement('div');
                    listaLugares.className = 'space-y-3';
                    lugaresAgrupados[categoria].forEach(lugar => createAndAppendLugar(lugar, listaLugares));
                    categoriaWrapper.appendChild(listaLugares);
                    proximosContainer.appendChild(categoriaWrapper);
                }
                
                if (!map) {
                    const apiKey = 'fQkLRhuKNXOuJ7C7hE32'; // Chave de API de exemplo MapTiler
                    map = new maplibregl.Map({
                        container: 'map',
                        style: `https://api.maptiler.com/maps/streets-v2/style.json?key=${apiKey}`,
                        center: [locationData.coordenadas.lng, locationData.coordenadas.lat],
                        zoom: 15
                    });

                    map.on('load', () => {
                        const barracaPopupContent = `<div class="text-center"><strong class="text-gray-800">${locationData.nome}</strong><br><a href="https://maps.google.com/?q=${locationData.coordenadas.lat},${locationData.coordenadas.lng}" target="_blank" rel="noopener noreferrer" class="map-directions-link">Ver Rotas</a></div>`;
                        new maplibregl.Marker({color: "#0138b4", scale: 1.2})
                            .setLngLat([locationData.coordenadas.lng, locationData.coordenadas.lat])
                            .setPopup(new maplibregl.Popup({ offset: 25 }).setHTML(barracaPopupContent))
                            .addTo(map);

                        const todosOsLugares = [...locationData.pontosTuristicos, ...locationData.lugaresProximos];
                        todosOsLugares.forEach(lugar => {
                            const lugarPopupContent = `<div class="text-center"><strong class="text-gray-800">${lugar.nome}</strong><br><a href="https://maps.google.com/?q=${lugar.coordenadas.lat},${lugar.coordenadas.lng}" target="_blank" rel="noopener noreferrer" class="map-directions-link">Ver Rotas</a></div>`;
                            new maplibregl.Marker({color: "#ef4444"})
                                .setLngLat([lugar.coordenadas.lng, lugar.coordenadas.lat])
                                .setPopup(new maplibregl.Popup({ offset: 25 }).setHTML(lugarPopupContent))
                                .addTo(map);
                        });
                    });
                } else {
                    map.resize();
                    map.flyTo({ center: [locationData.coordenadas.lng, locationData.coordenadas.lat], zoom: 15 });
                }
            });

            function closeMapModal() {
                mapModal.classList.add('hidden');
                document.body.style.overflow = '';
            }
            mapModalClose.addEventListener('click', closeMapModal);
            mapModal.addEventListener('click', (e) => { if (e.target === mapModal) closeMapModal(); });

            // --- Botão de Reservar ---
            document.getElementById('reserve-btn').addEventListener('click', (e) => {
                e.preventDefault(); 
                showToast('Redirecionando para a página de reserva...');
                setTimeout(() => { window.location.href = e.target.href; }, 1000);
            });
            
            // --- Galeria de Fotos Modal ---
            const galleryModal = document.getElementById('gallery-modal');
            const modalImage = document.getElementById('modal-image');
            const modalClose = document.getElementById('modal-close');
            const galleryImages = document.querySelectorAll('#gallery img');

            galleryImages.forEach(img => {
                img.addEventListener('click', () => {
                    modalImage.src = img.src;
                    galleryModal.classList.remove('hidden');
                });
            });

            function closeModal() { galleryModal.classList.add('hidden'); }
            modalClose.addEventListener('click', closeModal);
            galleryModal.addEventListener('click', (e) => { if (e.target === galleryModal) closeModal(); });

            
            // --- LÓGICA DA SEÇÃO DE AVALIAÇÃO (ATUALIZADA) ---
            const reviewFormContainer = document.getElementById('review-form-container');
            const userReviewPlaceholder = document.getElementById('user-review-placeholder');
            const deleteReviewBtn = document.getElementById('delete-review-btn');
            
            const ratingStarsContainer = document.getElementById('rating-stars');
            const ratingStars = [...ratingStarsContainer.children];
            const submitReviewBtn = document.getElementById('submit-review-btn');
            const reviewTextarea = document.getElementById('review-textarea');
            const reviewsList = document.getElementById('reviews-list');
            const filterButtons = document.querySelectorAll('.filter-btn');
            const reviewSummaryText = document.getElementById('review-summary-text');
            const reviewSummaryStars = document.querySelector('#review-summary .flex');

            let currentRating = 0;
            let totalReviews = 3;
            let totalRatingScore = 13; // (5 + 4 + 4)

            let userReviewElement = null; // Armazena a avaliação do usuário
            let userReviewRating = 0; // Armazena a nota da avaliação

            function updateStars(rating) {
                ratingStars.forEach(star => {
                    if (parseInt(star.dataset.value) <= rating) {
                        star.classList.remove('text-gray-300');
                        star.classList.add('text-yellow-400', 'fill-current');
                    } else {
                        star.classList.remove('text-yellow-400', 'fill-current');
                        star.classList.add('text-gray-300');
                    }
                });
            }

            function updateReviewSummary() {
                 if (totalReviews === 0) {
                     reviewSummaryText.textContent = `(0 avaliações)`;
                     const summaryStars = [...reviewSummaryStars.children];
                     summaryStars.forEach(star => star.classList.remove('fill-current'));
                     return;
                 }
                const averageRating = totalRatingScore / totalReviews;
                reviewSummaryText.textContent = `${averageRating.toFixed(1)} (${totalReviews} avaliações)`;
                
                const summaryStars = [...reviewSummaryStars.children];
                const roundedAverage = Math.round(averageRating);
                summaryStars.forEach((star, index) => {
                    star.classList.toggle('fill-current', index < roundedAverage);
                });
            }

            ratingStarsContainer.addEventListener('mouseover', (e) => {
                const starValue = e.target.dataset.value;
                if (starValue) updateStars(starValue);
            });
            ratingStarsContainer.addEventListener('mouseout', () => updateStars(currentRating));
            ratingStarsContainer.addEventListener('click', (e) => {
                const starValue = e.target.dataset.value;
                if (starValue) currentRating = parseInt(starValue);
            });

            // Enviar avaliação
            submitReviewBtn.addEventListener('click', () => {
                const reviewText = reviewTextarea.value.trim();
                if (currentRating === 0) {
                    showToast('Por favor, selecione uma nota.'); return;
                }
                if (reviewText === '') {
                    showToast('Por favor, escreva um comentário.'); return;
                }

                userReviewRating = currentRating; // Salva a nota
                totalReviews++;
                totalRatingScore += userReviewRating;
                updateReviewSummary();

                const newReview = document.createElement('div');
                newReview.className = 'review-card p-4 border rounded-lg bg-gray-50';
                newReview.dataset.rating = currentRating;
                
                let starsHTML = '';
                for (let i = 1; i <= 5; i++) {
                    starsHTML += `<i data-lucide="star" class="w-4 h-4 ${i <= currentRating ? 'fill-current' : ''}"></i>`;
                }

                newReview.innerHTML = `
                    <div class="flex items-center mb-2">
                        <img src="https://placehold.co/40x40/0138b4/FFFFFF?text=C" class="w-10 h-10 rounded-full mr-3" alt="Foto do Cliente">
                        <div>
                            <p class="font-bold">Você</p>
                            <div class="flex text-yellow-500">${starsHTML}</div>
                        </div>
                    </div>
                    <p class="text-gray-600">${reviewText}</p>
                `;
                reviewsList.prepend(newReview);
                userReviewElement = newReview; // Salva a referência
                lucide.createIcons();

                // Limpa o formulário
                reviewTextarea.value = '';
                // currentRating = 0; // Não precisa resetar aqui, pois já será escondido
                // updateStars(0);
                showToast('Avaliação enviada com sucesso!');

                // Esconde o formulário e mostra o botão de apagar
                reviewFormContainer.classList.add('hidden');
                userReviewPlaceholder.classList.remove('hidden');
            });
            
            // Apagar avaliação
            deleteReviewBtn.addEventListener('click', () => {
                if (userReviewElement) {
                    userReviewElement.remove(); // Remove o elemento do DOM
                    
                    // Atualiza os totais
                    totalReviews--;
                    totalRatingScore -= userReviewRating;
                    updateReviewSummary();

                    // Reseta
                    userReviewElement = null;
                    userReviewRating = 0;

                    // *** INÍCIO DO BUGFIX ***
                    currentRating = 0; // Reseta a nota atual
                    updateStars(0); // Limpa as estrelas visualmente
                    // *** FIM DO BUGFIX ***

                    // Mostra o formulário novamente
                    reviewFormContainer.classList.remove('hidden');
                    userReviewPlaceholder.classList.add('hidden');
                    
                    showToast('Sua avaliação foi removida.');
                }
            });
            
            // Filtros
            filterButtons.forEach(button => {
                button.addEventListener('click', () => {
                    filterButtons.forEach(btn => {
                        btn.classList.remove('bg-blue-500', 'text-white');
                        btn.classList.add('bg-gray-200', 'text-gray-800', 'hover:bg-gray-300');
                    });
                    button.classList.add('bg-blue-500', 'text-white');
                    button.classList.remove('bg-gray-200', 'text-gray-800');

                    const filterType = button.id;
                    const allReviews = reviewsList.querySelectorAll('.review-card');

                    allReviews.forEach(review => {
                        const show = (filterType === 'filter-all') || (filterType === 'filter-media' && review.classList.contains('has-media'));
                        review.style.display = show ? 'block' : 'none';
                    });
                });
            });
            
            updateReviewSummary();
        });
    </script>
</body>
</html>